<html tal:omit-tag=""
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  i18n:domain="silva_news"
  tal:define="
    formatdate nocall:context/service_news/format_date;">

  <style type="text/css">
    h2.heading {
      font-size: 3em;
    }

    .calendar td {
      text-align: center;
      vertical-align: middle;
    }

    .calendar th, .calendar td {
      text-align: center;
      vertical-align: middle;
      width: 2em;
      height: 2em;
      padding: 5px;
    }

    .calendar td.event a {
      color: #7BAA0F;
      text-decoration: none;
    }

    .calendar {
      margin-top: 20px;
      margin-bottom: 50px;
    }

    .newsitem {
      border-top: 1px dashed #7BAA0F;
      padding-top: 5px;
    }

    .event_actions {
      float: right;
    }

    .event_actions a {
      text-decoration: none;
      font-size: 0.8em;
    }

    .calendar_actions a {
      font-size: 0.8em;
    }

    .calendar_intro {
      color: #7BAA0F;
      margin: 0px 0px 30px 0px;
    }

    .calendar td.calendar_today {
      background-color: #ddd;
    }

    .calendar td.calendar_current {
      border: 1px solid #7BAA0F;
    }

  </style>

  <h2 class="heading" tal:content="context/get_title"
    tal:condition="not:context/suppress_title | context/suppress_title | nothing">View News</h2>

  <div class="calendar_actions">
    <a tal:attributes="href view/subscribe_url" class="next">subscribe</a>
  </div>

  <div class="calendar" tal:content="structure view/render_calendar" />
  <h3 class="calendar_intro" tal:content="view/intro" />

  <div class="newsitem" tal:repeat="event view/day_events">
    <div class="agenda_item_search_result news_item_search_result">
      <div class="event_actions">
        <a tal:attributes="href python: view.item_calevent_url(event)"
           title="Add this event to your calendar">
          <img tal:attributes="src python: view.browser_resource(date.png)" />
          Add to my calendar
        </a>
      </div>
      <h3 class="heading newsitemheading"
          tal:content="structure event/get_title">article title</h3>

      <div class="newsiteminfo"
        tal:define="
          publicationdate event/publication_time;
          displaydate event/display_datetime;
          formatdate nocall:event/service_news/format_date;">
       <tal:infopublic
         tal:condition="publicationdate">
        <p class="p newsiteminfopublicationdate">
         <tal:translate i18n:translate="">Publication: </tal:translate>
         <span class="newsitempublicationdate"
             tal:content="python: formatdate(displaydate or publicationdate)" />
        </p>
       </tal:infopublic>

       <tal:comment tal:omit-tag="">
         <!-- if the object is an agenda item -->
       </tal:comment>
       <p class="p eventdates"
         tal:define="
           startdate python: event.start_datetime(tz=context.get_timezone());
           enddate python: event.end_datetime(tz=context.get_timezone())"
         tal:condition="python: startdate or enddate">
        <tal:if condition="startdate">
         <span tal:omit-tag="" i18n:translate="">Start:</span>
         <tal:startdate replace="python: startdate.strftime('%Y-%m-%d')" />
        </tal:if>
        <tal:if condition="enddate"><br />
         <span tal:omit-tag="" i18n:translate="">End:</span>
         <tal:enddate replace="python: enddate.strftime('%Y-%m-%d')" />
        </tal:if>
       </p>
      </div>

      <div class="newsintro">
       <img
         tal:define="classname python: 'newsitem-thumbnail-odd'"
         tal:replace="structure python: event.get_thumbnail(classname)"
        />
      <!--   <tal:insertintro replace="structure r/get_intro" />-->
       <tal:insertintro
          replace="structure python:event.get_intro(max_size=128)" />
      </div>

      <p class="p articlelink">
       <a href="#"
          tal:attributes="href python:view.item_url(event)"
          i18n:translate="">
        more ...
       </a>
      </p>
    </div>
  </div>

  <p class="p archivelink">
    <a tal:attributes="href python: view.archive_url"
     i18n:translate="">
     view archive
   </a>
  </p>
</html>
