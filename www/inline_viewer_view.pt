<block 
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:notal="http://www.infrae.com/silva/notal"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:i18n="http://xml.zope.org/namespaces/tal/i18n"
  tal:omit-tag=""
  tal:define="model request/model;
              viewer options/viewer;
              viewerobj python:here.get_viewer_obj(viewer);
              limit python:int(options['number_of_articles']);
              items python:here.get_items(limit, viewer);
              mangle modules/Products/Silva/mangle;
              ">
<div tal:condition="not: viewerobj">
  No viewer available!
</div>

<tal:block tal:condition="viewerobj">
<div tal:attributes="class options/inv_div | nothing">

  <h3 tal:condition="python:options['show_title']=='1'"
    tal:content="python: viewerobj.get_title()">
    title
  </h3>

  <tal:block tal:condition="python:len(items) > 0">
    <tal:block tal:omit-tag="" tal:repeat="item items">
      <div class="newsitem">
        <tal:block tal:define="title item/title">
          <h4 tal:condition="python:options['show_link_article'] == 'separate'"
            tal:content="structure title">
            title
          </h4>
          <h4 tal:condition="python:options['show_link_article'] != 'separate'">
            <a tal:attributes="href item/link"
                tal:content="structure title">
              title
            </a>
          </h4>
        </tal:block>
  
        <tal:block tal:define="maxchars python: int(options['number_of_characters'])">
          <tal:block tal:define="intro python:item.intro(maxchars)"
              tal:content="structure intro"
              tal:condition="python: options['show_intro']=='intro'">
            Lead
          </tal:block>
          <tal:block tal:define="intro python: item.description(maxchars)"
              tal:content="structure intro"
              tal:condition="python:(not item.intro() or 
                options['show_intro']=='description')">
            Lead
          </tal:block>
        </tal:block>
  
        <p class="p newsitem-data">
          <span i18n:translate="" 
            tal:condition="python:(int(options['show_creationdate']) and 
              item.creation_datetime())">
            Creation date/time: 
            <span i18n:name="datetime" 
                tal:replace="python:mangle.DateTime(item.creation_datetime()).toStr()"
                tal:condition="python:int(options['show_creationdate'])">
              date
            </span><br />
          </span>
          <span tal:condition="python: item.start_datetime() and options['show_datetime']=='1'"
            i18n:translate="">
            Start date/time:
            <span i18n:name="datetime"
              tal:replace="python:mangle.DateTime(item.start_datetime()).toStr()">
              date
            </span><br />
          </span>
          <span i18n:translate="" tal:condition="item/end_datetime">
            End date/time:
            <span i18n:name="datetime"
              tal:replace="python:mangle.DateTime(item.end_datetime()).toStr()">
              date
            </span><br />
          </span>
          <span i18n:translate="" 
            tal:condition="python: (int(options['show_location']) and item.location())">
            Location:
            <span i18n:name=""
              tal:replace="item/location">
              location
            </span><br />
          </span>
          <tal:block tal:condition="python: options['show_link_article'] == 'separate'">
            <a tal:attributes="href item/link"
              tal:content="structure options/link_text_article">
              view item
            </a>
          </tal:block>
        </p>

      </div>
    </tal:block>
  </tal:block>
  <p class="p" tal:condition="python:len(items) <= 0">
    <i>There are no articles available.</i>
  </p>

  <p class="p newsviewer-otherarticles" tal:condition="python:options['show_link']=='1'">
    <br />
    <a tal:attributes="href python:viewerobj.absolute_url()"
        tal:content="structure options/link_text_viewer">
      View other articles
    </a>
  </p>

  <metal:block use-macro="here/feed_footer/macros/footer" /> 

</div>
</tal:block>
</block>
