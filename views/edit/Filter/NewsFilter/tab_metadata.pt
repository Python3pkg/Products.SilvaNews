<tal:block define="global breadcrumb_vein string:Contents;" />
<!-- ___________________________ start index_html ___________________________ -->
<html  metal:use-macro="here/macro_index/macros/master">

<div class="margins"
  metal:fill-slot="main">
<!-- ___________________________ start index_html/slot main ___________________________ -->

<script language="JavaScript">
<!--

lookupWindow = null;
textArea = null;
referenceFormat = null;
appendValue = false;
// Called from getAssetReference
function openAssetLookupWindow(url_to_open) {
  // Do the opening
  width = 560;
  height = 280;
  leftPos = (screen.width - width) / 2;
  topPos = (screen.height - height) / 2;
  aspects = 'toolbar=yes,status=yes,scrollbars=yes,width='+width+',height='+height+',left='+leftPos+',top='+topPos;
  lookupWindow = window.open(
    url_to_open, 'AssetLookupWindow', aspects);
  lookupWindow.focus();
}
// Called from "pagetemplate"
function getAssetReference(url, format, form, element, append) {
  // Store reference to focused text area
  referenceFormat = format;
  doc = document.all ? document.all : document;
  textArea = eval('doc.'+form+'.'+element);
  if (append)
    appendValue = true;
  // Open LookupWindow
  openAssetLookupWindow(url);
}
// Called from "asset lookup window"
function insertAssetReference(id, reference, wndw) {
  // Append to previously focused text area
  // FIXME: We'd like to make it work with selections in
  // the textarea.
  append_text = referenceFormat.replace('_id_', id).replace('_reference_', reference);
  if (appendValue)
    append_text = textArea.value + append_text;
  textArea.value = append_text;
  textArea.focus();
  // Close LookupWindow
  wndw.close();
}

//-->
</script>
<tal:block tal:define="dummy python: request.SESSION.set('filter', 'Image')" />

<h2><img src="%s" width="16" height="16" alt="%s"
     tal:replace="structure python:view.render_icon(model.meta_type)" />&nbsp;
  Metadata for <span class="document-title" tal:content="structure string:&#xab;${model/get_title_html}&#xbb;">title here</span>
</h2>

<init tal:omit-tag=""
  tal:define="global fields python:view.tab_metadata_form.get_fields()" />

<form method="POST" name="form" action="tab_metadata_submit">

<table width="96%" cellspacing="0" cellpadding="3" border="0"
  tal:attributes="width container/table_width; cellspacing container/table_cellspacing;
                  cellpadding container/table_cellpadding; border container/table_border">
<tr>
<th align="left">
Element
</th>
<th align="right">
&nbsp;
</th>
<th align="left">
Content
</th>
<th align="left" width="40%">
Note
</th>
</tr>

<tal:comment condition="nothing"> __________ Start repeat ___________ </tal:comment>
<fieldset class="logic"
  tal:repeat="field fields"
  tal:omit-tag="">

<rowset class="logic"
  tal:define="oddrow repeat/field/odd"
  tal:omit-tag="">

<tr class="focus" valign="top"
  tal:attributes="class python:test(oddrow, 'focus', 'focus-cycle')" tal:define="global lastclass python:test(oddrow, 'focus', 'focus-cycle')">
<td align="right">
<span tal:replace="structure string:${field/title}:">Title</span>
</td>
<td align="right">
<span class="warning"
  tal:condition="python:field.is_required()">
*
</span>
<span class="logic"
  tal:condition="not:python:field.is_required()"
  tal:omit-tag="">
&nbsp;
</span>
</td>
<td align="left">
<input tal:replace="structure python:field.render(value=test(field.id == 'document_title', model.get_title_editable(), model.getProperty(field.id)) )" />
</td>
<td>
<span tal:replace="python:field.get_value('description')">
comments here (field description)
</span><br />
<span tal:condition="python:field.id == 'contact_name' or field.id == 'contact_email'" tal:omit-tag="">(<i tal:content="python:getattr(model, field.id, 'None')"></i>)</span>
</td>
</tr>
</rowset>
</fieldset>

<tal:comment condition="nothing"> __________ End repeat, image input ___________ </tal:comment>

<tr class="focus" valign="top"
  tal:attributes="class python:test(lastclass=='focus-cycle', 'focus', 'focus-cycle')" tal:define="global lastclass python:test(lastclass=='focus-cycle', 'focus', 'focus-cycle')">
<td align="right">
Select image:
</td>
<td align="right">
&nbsp;
</td>
<td align="left">
<input class="button" type="button" tal:attributes="onClick string:getAssetReference('${model/absolute_url}/edit/asset_lookup', '_reference_', 'form', 'rss_image', 0);" value=" Locate " /><br />
<input type="text" name="rss_image" size="60" tal:attributes="value model/rss_image" />
</td>
<td>
If you choose an image here, it will be added to the RSS feed.</td>
</tr>

<tr class="controls">
<td colspan="4" align="right">
<input class="button" type="submit"
       name="form_submitted" value="Save metadata" 
       title="Accesskey: alt-s" accesskey="s"
       />
</td>
</tr>
</table>
</form>
<br />

<span tal:replace="structure here/tab_metadata_extra | nothing" tal:omit-tag="" />

<table width="96%" cellspacing="0" cellpadding="3" border="0"
  tal:attributes="width container/table_width; cellspacing container/table_cellspacing;
    cellpadding container/table_cellpadding; border container/table_border">
<tr valign="top">
  <td align="right" width="15%">
    Chief Editor(s):
  </td>
  <td>&nbsp;</td>
  <td align="left">
    <span tal:replace="python:', '.join([ch.fullname() for ch in here.get_nearest_chiefeditors()])" />
  </td>
  <td width="30%">&nbsp;</td>
</tr>

<tr valign="top">
  <td align="right">
    Manager(s):
  </td>
  <td>&nbsp;</td>
  <td align="left">
    <span tal:replace="python:', '.join([m.fullname() for m in here.get_nearest_managers()])" /> <br />
  </td>
  <td>&nbsp;</td>
</tr>

</table>

<!-- ___________________________ end index_html/slot main ___________________________ -->
</div>

</html>
<!-- ___________________________ end index_html ___________________________ -->
