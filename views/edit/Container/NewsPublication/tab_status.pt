<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html tal:omit-tag=""
  lang="en"
  xml:lang="en"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  tal:define="
  vein string:publish;
  "
  i18n:domain="silva_news">
<metal:block use-macro="here/macro_index/macros/master">
<metal:block fill-slot="main">

<form action="."
  method="POST"
  name="silvaObjects"
  tal:define="
    objects model/get_processed_status_tree;
    
    refs options/refs | python: [];
    redisplay_timing_form request/redisplay_timing_form | options/redisplay_timing_form | python: 1;

    global approveables nothing;
    global rejectables nothing;
    global revokeables nothing;
    global closeables nothing;
    global new_versionables nothing;
    global expireables nothing;
  ">
  <table class="columns columns2">
    <tbody>
      <tr>
        <tal:block replace="nothing">
          _____________________ sidebar _____________________
        </tal:block>
        <td class="left">
          <metal:use-macro use-macro="view/macro_vein_navigation/macros/vein">
            <metal:fill-slot fill-slot="sidebar">
              <tal:block replace="structure python: view.service_sidebar.render(model, 'tab_status', vein)" />
            </metal:fill-slot>
          </metal:use-macro>
        </td>

        <tal:block replace="nothing">
          _____________________ main _____________________
        </tal:block>
        <td class="main">

<table class="listing">
  <thead>
    <tal:block replace="nothing">
      ______________ vein + title row ______________
    </tal:block>
    <tr>
      <td class="top"
        colspan="6">
        <h2 tal:attributes="title string:id: ${model/id}">
          <img tal:replace="structure python:view.render_icon(model)" />
          &#xab;<span tal:replace="title">title</span>&#xbb;
        </h2>
      </td>
    </tr>
    <tal:block replace="nothing">
      ______________ top controls row ______________
    </tal:block>
    <tr class="top-controls">
      <td colspan="6" class="align-right">
        <h3 style="float:left;" i18n:translate="">
          publishing actions
        </h3>
        <input class="transport"
          name="tab_status_export:method"
          type="submit"
          accesskey="e"
          value="export..."
          tal:define="type python:test(model.meta_type == 'Silva Folder', 'Folder', 'Publication')"
          tal:attributes="
            title string:export this ${type}: alt-e;"
          i18n:attributes="value;accesskey export_accesskey"
	       />
      </td>
    </tr>
  </thead>
  <tbody>
    <tr tal:condition="objects">
      <th class="listing-left">
        &nbsp;
      </th>
      <th i18n:translate="">
        modify / preview
      </th>
      <th class="align-right" i18n:translate="">
        revision
      </th>
      <th class="align-right" i18n:translate="">
        publication due
      </th>
      <th class="align-right" i18n:translate="">
        expiration due
      </th>
      <th class="align-right" i18n:translate="">
        published
      </th>
    </tr>
    <tal:block replace="nothing">
      ______________ iteration ______________
    </tal:block>
    <tal:block repeat="obj objects">
      <tr
        tal:define="
          iterate repeat/obj/odd;
          is_container obj/implements_container | nothing;
          indent_depth python: '%spx' % str(obj['indent'] * 10);
          obj_url obj/absolute_url;
          state obj/status_style | nothing;
          global rejectables python: test(state == 'pending', 1, rejectables);
          global revokeables python: test(state == 'approved', 1, revokeables);
          global approveables python: test(state == 'draft', 1, approveables);
          global new_versionables python: test(state == 'closed', 1, new_versionables);"
        tal:attributes="
          class python: iterate and 'odd' or 'even';">
        <td class="listing-left">
          <input name="refs:list"
            type="checkbox"
            value="value"
            tal:define="ref obj/ref | nothing"
            tal:condition="ref"
            tal:attributes="
              value ref;
              checked python: ref in refs and 'checked' or nothing;
              "
          />
        </td>
        <tal:block replace="nothing">
          _______ icon/title cell _______
        </tal:block>
        <td>
          <div tal:attributes="style string:margin-left:${indent_depth}">
            <div style="float: left;">
              <a class="icon"
                tal:attributes="href string:${obj_url}/edit/tab_edit;
                title python: here.tab_status_get_modify_title(obj['meta_type']);
                ">
                <img tal:replace="structure obj/icon" />
              </a>
            </div>
            <div style="padding-left: 19px;"
              tal:define="title obj/title">
              <a class="blacklink"
                tal:attributes="
                  class obj/status_style | default;
                  href string:${obj_url}/edit/tab_preview;
                  title python:here.tab_status_get_preview_title(obj['id']);
                  ">
                <tal:block condition="obj/is_default | nothing">
                  <em i18n:translate="">
                    index of
                  </em>
                  <tal:block condition="title" replace="title" />
                  <em tal:condition="not:title" tal:content="obj/id">id</em>
                </tal:block>
                <tal:block condition="not:obj/is_default | nothing">
                  <tal:block condition="title" replace="title" />
                  <em tal:condition="not:title" tal:content="obj/id">id</em>
                </tal:block>
              </a>
            </div>
          </div>
        </td>
        <tal:block replace="nothing">
          _______ revision cell _______
        </tal:block>
        <td class="align-right">
          <a title="publish"
            tal:condition="obj/status | nothing"
            tal:attributes="
              class obj/status_style | default;
              href string:${obj_url}/edit/tab_status;"
              i18n:attributes="title">
              <tal:block content="obj/status">
              </tal:block>
          </a>
          <a class="closed"
            title="publish"
            tal:condition="is_container"
            tal:attributes="
            href string:${obj_url}/edit/tab_status;"
            i18n:attributes="title">
            <em i18n:translate="">n/a</em>
          </a>
        </td>
        <tal:block replace="nothing">
          _______ publication datetime cell _______
        </tal:block>
        <td class="align-right">
          <span
            tal:content="structure obj/next_version_publication_datetime | nothing" 
            tal:attributes="class obj/status_style | default;"
          />
        </td>
        <tal:block replace="nothing">
          _______ expiration datetime cell _______
        </tal:block>
        <td class="align-right">
          <span
            tal:define="
              expire_time obj/next_version_expiration_datetime | nothing;
              global expireables python:expire_time and 1 or expireables;"
            tal:content="structure expire_time" 
            tal:attributes="class obj/status_style | default;"
          />
        </td>
        <tal:block replace="nothing">
          _______ public version cell _______
        </tal:block>
        <td class="align-right"
          tal:define="
            public_status obj/public_status | nothing;
            start_time obj/public_version_publication_datetime | nothing;
            end_time obj/public_version_expiration_datetime | nothing">
          <a href="tab_status"
            title="public version"
            tal:attributes="href obj_url;"
            tal:condition="python: public_status == 'published'"
            i18n:attributes="title">
            <tal:block
              define="
                global closeables python: 1;
                global new_versionables python: state != 'pending' and state != 'approved';
                global expireables python:end_time and 1 or expireables;"
              condition="start_time"
              replace="
                python: '%s%s' % (start_time, test(end_time, ' - %s' % end_time, ''))">
            </tal:block>
          </a>
          <tal:block 
            condition="python: public_status == 'closed'"> 
            <span i18n:translate=""
              define="
                global new_versionables python: closed and (state != 'pending' and state != 'approved') or new_versionables;">
              closed
            </span>
          </tal:block>
        </td>
      </tr>
    </tal:block>
    <tal:block replace="nothing">
      ______________ if empty ______________
    </tal:block>
    <tr class="even"
      tal:condition="not: objects">
      <td 
        colspan="6" i18n:translate="">
        There are no publishable items here.
      </td>
    </tr>
  </tbody>
  <tfoot tal:condition="may_change_content">
    <tr tal:condition="objects">
      <th class="listing-left"
        colspan="2">
        <tal:define define="select_id string:refs">
          <metal:block use-macro="view/macro_select_all/macros/select_all" />
        </tal:define>
      </th>
      <th class="align-right"
        colspan="4">
        <span tal:condition="
          python: approveables or ((closeables or revokeables or rejectables) and may_approve_content)">
          <tal:block i18n:translate="">day / month / year</tal:block> &nbsp;23:59
        </span>
      </th>
    </tr>
    <tr class="controls inter-controls"
      tal:condition="
        python: approveables or ((revokeables or rejectables or new_versionables) and may_approve_content)">
      <tal:block replace="nothing">
        ______________ publication time controls ______________
      </tal:block>
      <td class="align-right"
        style="padding-right:0.5em;"
        colspan="6">
        <label 
          title="access key: alt-m" 
          accesskey="m"
          i18n:attributes="title;accesskey publish_time_accesskey"
          i18n:translate=""
          >
          publish time
        </label>
        <tal:block
          condition="redisplay_timing_form"
          replace="structure python: view.tab_status_form.publish_datetime.render_from_request(request)" 
        />
        <tal:block
          tal:condition="not: redisplay_timing_form"
          tal:replace="structure python: view.tab_status_form.publish_datetime.render()" 
        />
        &nbsp;&nbsp;
        <tal:block replace="nothing">
          ______________ expiration time controls ______________
        </tal:block>
        <label title="access key: alt-x" 
          accesskey="x" 
          i18n:attributes="title;accesskey expiration_time_accesskey"
          i18n:translate="">
          expiration time
        </label>
        <tal:block 
          condition="redisplay_timing_form"
          replace="structure python: view.tab_status_form.expiration_datetime.render_from_request(request)" 
        />      
        <tal:block 
          condition="not: redisplay_timing_form"
          replace="structure python: view.tab_status_form.expiration_datetime.render()" 
        />      
      </td>
    </tr>
    <tr class="controls inter-controls"
      tal:condition="python: may_approve_content and (approveables or ((revokeables or rejectables or new_versionables)))">
      <td class="align-right"
          colspan="6">
        <tal:block 
          condition="python: may_approve_content and expireables">
          <label for="clear_expiration"
            title="access key: alt-p"
            accesskey="p"
            i18n:attributes="title;accesskey clear_expiration_accesskey"
            i18n:translate="">
            clear&nbsp;ex<u>p</u>iration
          </label>
          <field tal:replace="structure view/tab_status_form/clear_expiration/render" />
        </tal:block>
        &nbsp;&nbsp;
        <tal:block replace="nothing">
          ______________ news-specific control ______________
        </tal:block>
        <tal:block condition="may_approve_content">
          <label for="update_display_datetime" 
            i18n:attributes="title"
            i18n:translate="">
            update display date/time
          </label>
          <tal:block 
            condition="redisplay_timing_form"
            replace="structure python:view.tab_status_form_news.update_display_datetime.render_from_request(request)" 
          />
          <tal:block 
            condition="not: redisplay_timing_form"
            replace="structure python:view.tab_status_form_news.update_display_datetime.render()" 
          />
        </tal:block>
        &nbsp;&nbsp;
        <tal:block condition="may_approve_content">
          <label 
            for="publish_now_flag" 
            title="access key: alt-u" 
            accesskey="u"
            i18n:attributes="title;accesskey publish_now_accesskey"
            i18n:translate="">
            p<u>u</u>blish&nbsp;now?
          </label>
          <tal:block 
            condition="redisplay_timing_form"
            replace="structure python:view.tab_status_form.publish_now_flag.render_from_request(request)" 
          />
          <tal:block 
            condition="not: redisplay_timing_form"
            replace="structure python:view.tab_status_form.publish_now_flag.render()" 
          />
        </tal:block>
      </td>
    </tr>
    <tal:block replace="nothing">
      ______________ editor controls ______________
    </tal:block>
    <tr class="controls"
      tal:condition="may_approve_content">
      <td colspan="2"
        style="border-style:none;">
        <input class="reject"
          type="submit"
          name="tab_status_reject:method"
          value="reject" 
          title="reject pending request for approval: alt-j"
          accesskey="j"
          tal:condition="rejectables"
          i18n:attributes="value;title;accesskey reject_accesskey"
        />
        <input class="revoke"
          type="submit"
          name="tab_status_revoke:method"
          value="revoke"
          title="withdraw approval of approved versions: alt-v"
          accesskey="v"
          tal:condition="revokeables"
          i18n:attributes="value;title;accesskey revoke_accesskey"
        />
        <input class="close"
          type="submit"
          name="tab_status_close:method"
          value="close"
          title="close published items: alt-c"
          accesskey="c"
          tal:condition="closeables"
          i18n:attributes="value;title;accesskey close_accesskey"
        />
        <input class="button" 
          type="submit" 
          name="tab_status_new_version:method" 
          value="new version" 
          title="create new versions of published docs: alt-n" 
          accesskey="n"
          tal:condition="new_versionables"
          i18n:attributes="value;title;accesskey new_version_accesskey"
        />
      </td>
      <td class="align-right"
        colspan="4">
        <input class="button"
          name="tab_status_change_settings:method"
          type="submit"
          value="set timing"
          title="change publish and expiration times: alt-s"
          accesskey="s"
          tal:condition="python: approveables or closeables or revokeables or rejectables"
          i18n:attributes="value;title;accesskey set_timing_accesskey"
        />
        <input class="button"
          name="tab_status_approve:method"
          type="submit"
          value="open to public"
          title="approve or publish new versions: alt-o"
          accesskey="o"
          tal:condition="python: approveables or rejectables or new_versionables"
          i18n:attributes="value;title;accesskey open_to_public_accesskey"
        />
      </td>
    </tr>
    <tr class="controls"                  
      tal:condition="not:may_approve_content">
      <tal:block replace="nothing">
        ______________ author controls ______________
      </tal:block>
      <td colspan="3"
        style="border-style:none;">
        <input class="reject"
          type="submit"
          name="tab_status_withdraw:method"
          value="withdraw"
          title="withdraw pending request for approval: alt-w"
          accesskey="w"
          tal:condition="rejectables"
          i18n:attributes="value;title;accesskey withdraw_accesskey"
        />
        <input class="revoke"
          accesskey="v"
          name="tab_status_revoke:method"
          title="revoke approval of approved versions: alt-v"
          type="submit"
          value="revoke"
          tal:condition="revokeables"
          i18n:attributes="value;title;accesskey revoke_accesskey"
        />
        <input class="button" 
          type="submit" 
          name="tab_status_new_version:method" 
          value="new version" 
          title="create new versions of published docs: alt-n" 
          accesskey="n"
          tal:condition="new_versionables"
          i18n:attributes="value;title;accesskey new_version_accesskey"
        />
      </td>
      <td class="align-right"
        colspan="2">
        <input class="button"
          name="tab_status_change_settings:method"
          type="submit"
          value="set timing"
          title="change publish and expiration times: alt-s"
          accesskey="s"
          tal:condition="python: approveables"
          i18n:attributes="value;title;accesskey set_timing_accesskey"
        />
      </td>
      <td class="align-right">
        <input class="button"
          type="submit"
          name="tab_status_request_approval:method"
          value="request approval"
          title="request approval for new versions: alt-r"
          accesskey="r"
          tal:condition="approveables"
          i18n:attributes="value;title;accesskey request_approval_accesskey"
        />
      </td>
    </tr>
  </tfoot>
</table>

        </td>
      </tr>
    </tbody>
  </table>
</form>
</metal:block>
</metal:block>
</html>
